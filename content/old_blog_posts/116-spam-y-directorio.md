+++
date = "2010-01-17"
title = "Spam y directorio."
+++
Wow, acabo de validar 300 paginas web en el [directorio web](http://directorioweb.me) que tengo. Estas son mis impresiones: 10% Paginas de alta calidad 40% Paginas de media calidad 20% Paginas de calidad baja 30% Spam vil y malo. De ese 30% de spam mucho venia de un tal anselmo.chambers ya le he baneado todos los dominios en caso de que trate de hacer spam otra vez jojojo, ya que el muy inteligente uso ip diferentes para cada envi lololol el tip de desconectar y reconectar el mdem, pero no contaba que en el whois todos sus dominios compartian el mismo email, DNS, probablemente la misma ip pero no cheque, etc. As que cree un script php para desahecerme de el :>.

> <? $host="localhost"; $database="removed"; $dbusername="removed"; $dbpassword="removed"; function conectar() { global $host, $database, $dbusername, $dbpassword; $link = mysql\_connect("$host", "$dbusername", "$dbpassword"); if (!$link) { /\*die('Could not connect: ' . mysql\_error());\*/ echo "<center><h1>Configure el acceso a base de datos.</h1></center>"; } mysql\_select\_db("$database"); } function getDomain($url) { if(filter\_var($url, FILTER\_VALIDATE\_URL, FILTER\_FLAG\_HOST\_REQUIRED) === FALSE) { return false; } $parts = parse\_url($url); /\*\*\* return the host domain \*\*\*/ return $parts['host']; } function cleandomain($url) { while(substr\_count($url,".") > 1) { if(substr\_count($url,".") == 2) { //Esto es para los subdominios $point2 = stripos($url,"."); $tempurl = substr($url,$point2+1); //tempurl tendra la forma xxx.xxx $point2 = stripos($tempurl,"."); if($point2 < 4) { return $url; break; } } $point = stripos($url,"."); $url = substr($url,$point+1); } return $url; } conectar(); $query = "SELECT id, url FROM paginas WHERE validada = 0"; $result = mysql\_query($query); while($row = mysql\_fetch\_row($result)) { $output=""; $domain = getDomain($row[1]); $domain = cleandomain($domain); exec("whois $domain", &$output); $texto = implode("n", $output); if(stripos($texto,"anselmo.chambers") !== FALSE || stripos($texto,"NS02.ONEWORLDOFFICE.NET") !== FALSE) { echo "!!! "; $query = "UPDATE paginas SET baneada='1' WHERE id = '$row[0]'"; mysql\_query($query); } sleep(3); echo $domain. "n"; } ?>Esto lo ejecuto desde la consola del servidor, un script como este de cara al publico es un gran problema de seguridad. En fin si quieren ganar visitas no olviden enviar su pagina web a mi [directorio web](http://directorioweb.me). Tambin estoy creando una lista de directorios que no piden reciproco obligatorio, una vez la tenga completa se las pongo por aqui para que ustedes enven sus paginas tambien.
